var Ge=Object.defineProperty;var Qe=(t,e,n)=>e in t?Ge(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var D=(t,e,n)=>Qe(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const Xe={recipe:null};async function ne(){}function Ze(){return Xe.recipe}const Ae="admin:enabled";function et(){const t=new URL(location.href);if(t.searchParams.has("admin")){const e=t.searchParams.get("admin"),n=e===""||e==="1"||(e==null?void 0:e.toLowerCase())==="true";localStorage.setItem(Ae,n?"1":"0"),n&&history.replaceState(null,"",t.pathname+t.hash)}}function tt(){return!1&&localStorage.getItem(Ae)==="1"}async function nt(){try{const t=await fetch("/api/auth/me",{credentials:"include"});return t.ok?await t.json():null}catch{return null}}function rt(t){var n,r;const e=((n=t==null?void 0:t.user)==null?void 0:n.roles)||[];return((r=t==null?void 0:t.user)==null?void 0:r.is_admin)===!0||e.includes("admin")||e.includes("owner")}let q=null;async function pe(){if(tt())return!0;const t=Date.now();if(q&&t-q.at<1e4)return q.val;const e=await nt(),n=rt(e);return q={at:t,val:n},n}function He(){return document.cookie.split(";").map(e=>e.trim()).some(e=>e.startsWith("sa_dev="))}function ot(){if(!He()){console.log("[Dev Overlay] Not enabled (no sa_dev cookie found)");return}console.log("[Dev Overlay] Enabled - mounting badge");const t=document.createElement("div");t.dataset.testid="dev-overlay",t.textContent="DEV",t.style.cssText=`
    position: fixed;
    right: 12px;
    bottom: 12px;
    padding: 6px 8px;
    border-radius: 6px;
    background: #111;
    color: #fff;
    font: 600 12px/1 system-ui;
    z-index: 99999;
    cursor: pointer;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    transition: transform 0.2s;
  `,t.addEventListener("mouseenter",()=>{t.style.transform="scale(1.1)"}),t.addEventListener("mouseleave",()=>{t.style.transform="scale(1)"}),t.addEventListener("click",async()=>{try{const n=await(await fetch("/agent/dev/status")).json();alert(`Dev Overlay Status:
${JSON.stringify(n,null,2)}`)}catch(e){console.error("[Dev Overlay] Failed to fetch status:",e)}}),document.body.appendChild(t),console.log("[Dev Overlay] Badge mounted successfully")}async function st(t="dev"){try{const e=await fetch("/agent/dev/enable",{headers:{Authorization:`Bearer ${t}`}});if(!e.ok)return console.error("[Dev Overlay] Enable failed:",e.status),!1;const n=await e.json();return console.log("[Dev Overlay] Enabled:",n),window.location.reload(),!0}catch(e){return console.error("[Dev Overlay] Enable error:",e),!1}}if(typeof window<"u"){const e=new URLSearchParams(window.location.search).get("dev_overlay");e&&!He()&&(console.log("[Dev Overlay] Auto-enabling from URL parameter"),st(e))}class it{constructor(){D(this,"projects",[]);D(this,"currentFilter","all");D(this,"gridContainer");D(this,"loadingElement",null);D(this,"emptyElement");D(this,"observer");if(this.gridContainer=document.getElementById("portfolio-grid"),this.emptyElement=document.getElementById("portfolio-empty"),!this.gridContainer||!this.emptyElement){console.warn("Portfolio elements not found");return}this.loadingElement=this.gridContainer.querySelector(".portfolio-loading"),this.observer=new IntersectionObserver(e=>{e.forEach(n=>{if(n.isIntersecting){const r=n.target,s=r.dataset.src;s&&(r.src=s,r.removeAttribute("data-src"),this.observer.unobserve(r))}})},{rootMargin:"50px"}),this.setupFilterListeners(),this.loadProjects()}setupFilterListeners(){const e=document.querySelectorAll(".filter-btn");e.forEach(n=>{n.addEventListener("click",r=>{const s=r.currentTarget,o=s.dataset.filter||"all";e.forEach(a=>a.classList.remove("active")),s.classList.add("active"),this.currentFilter=o,this.renderProjects()})})}async loadProjects(){try{const e=await fetch("/projects.json");if(!e.ok)throw new Error(`Failed to fetch projects: ${e.status}`);const n=await e.json();this.projects=Object.values(n),console.log(`Loaded ${this.projects.length} projects`),this.renderProjects()}catch(e){console.error("Error loading projects:",e),this.showEmpty()}}renderProjects(){if(!this.gridContainer)return;this.gridContainer.innerHTML="";const e=this.currentFilter==="all"?this.projects:this.projects.filter(r=>r.tags.some(s=>s.toLowerCase().includes(this.currentFilter.toLowerCase())));if(console.log(`Rendering ${e.length} projects (filter: ${this.currentFilter})`),e.length===0){this.showEmpty();return}this.emptyElement&&(this.emptyElement.style.display="none"),e.forEach((r,s)=>{const o=this.createProjectCard(r,s);this.gridContainer.appendChild(o)}),this.gridContainer.querySelectorAll("img[data-src]").forEach(r=>this.observer.observe(r))}createProjectCard(e,n){const r=document.createElement("div");r.className="project-card",r.style.animationDelay=`${n*.05}s`,r.setAttribute("data-card",e.slug);const s=e.thumbnail||"/placeholder.svg",o=this.escapeHtml(e.title),a=this.escapeHtml(e.description||e.problem||"No description available."),c=e.tags.slice(0,4).map(l=>`<span class="project-tag">${this.escapeHtml(l)}</span>`).join("");let _="";return e.demo&&(_=`
        <a href="${e.demo}" target="_blank" rel="noopener noreferrer" class="project-link">
          View Project â†’
        </a>
      `),r.innerHTML=`
      <div class="project-thumbnail">
        <img data-src="${s}" alt="${o}" loading="lazy" />
      </div>
      <div class="project-content">
        <h3 class="project-title">${o}</h3>
        ${c?`<div class="project-tags">${c}</div>`:""}
        <p class="project-description">${a}</p>
        ${_}
      </div>
    `,r}showEmpty(){!this.gridContainer||!this.emptyElement||(this.gridContainer.innerHTML="",this.emptyElement.style.display="block")}escapeHtml(e){const n=document.createElement("div");return n.textContent=e,n.innerHTML}}document.addEventListener("DOMContentLoaded",()=>{console.log("Portfolio UI initialized"),new it});et();ne();const re="https://calendly.com/leoklemet-pa";function at(){if(window.__CALENDLY_STARTED__)return;window.__CALENDLY_STARTED__=!0;const t=document.querySelector(".calendly-inline-widget");t&&t.setAttribute("data-url",re),typeof window.Calendly<"u"&&window.Calendly.initInlineWidget({url:re,parentElement:document.querySelector(".calendly-inline-widget"),prefill:{},utm:{}})}document.addEventListener("DOMContentLoaded",()=>{at();const t=document.getElementById("calendly-popup-btn");t&&t.addEventListener("click",n=>(n.preventDefault(),typeof window.Calendly<"u"&&window.Calendly.initPopupWidget({url:re}),!1));const e=n=>{const r=document.getElementById(n);r&&r.addEventListener("click",async()=>{try{const s=await fetch("/resume/copy.txt?limit=2600",{credentials:"include"});if(!s.ok)throw new Error(`Failed to fetch resume: ${s.status}`);const o=await s.text();await navigator.clipboard.writeText(o);const a=r.innerHTML,c=r.querySelector(".contact-icon");if(c){c.textContent="âœ…";const _=r.querySelector("span:not(.contact-icon)");_&&(_.textContent="Copied!")}else r.innerHTML="âœ… Copied!";setTimeout(()=>{r.innerHTML=a},2e3)}catch(s){console.error("Failed to copy resume:",s);const o=r.querySelector(".contact-icon");o?o.textContent="âŒ":r.innerHTML="âŒ Failed",setTimeout(()=>{o?o.textContent="ðŸ“‹":r.innerHTML="ðŸ“‹ Copy for LinkedIn"},2e3)}})};e("copy-linkedin-btn"),e("copy-linkedin-btn-footer")});window.addEventListener("layout:update",t=>{console.log("Layout loaded:",t.detail)});ot();console.log("Portfolio shell initialized");var Z,w,Oe,j,he,De,Ne,je,ce,oe,se,B={},Ie=[],lt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ee=Array.isArray;function $(t,e){for(var n in e)t[n]=e[n];return t}function _e(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function ct(t,e,n){var r,s,o,a={};for(o in e)o=="key"?r=e[o]:o=="ref"?s=e[o]:a[o]=e[o];if(arguments.length>2&&(a.children=arguments.length>3?Z.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)a[o]===void 0&&(a[o]=t.defaultProps[o]);return V(t,a,r,s,null)}function V(t,e,n,r,s){var o={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:s??++Oe,__i:-1,__u:0};return s==null&&w.vnode!=null&&w.vnode(o),o}function W(t){return t.children}function Y(t,e){this.props=t,this.context=e}function U(t,e){if(e==null)return t.__?U(t.__,t.__i+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?U(t):null}function Fe(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Fe(t)}}function me(t){(!t.__d&&(t.__d=!0)&&j.push(t)&&!Q.__r++||he!=w.debounceRendering)&&((he=w.debounceRendering)||De)(Q)}function Q(){for(var t,e,n,r,s,o,a,c=1;j.length;)j.length>c&&j.sort(Ne),t=j.shift(),c=j.length,t.__d&&(n=void 0,r=void 0,s=(r=(e=t).__v).__e,o=[],a=[],e.__P&&((n=$({},r)).__v=r.__v+1,w.vnode&&w.vnode(n),ue(e.__P,n,r,e.__n,e.__P.namespaceURI,32&r.__u?[s]:null,o,s??U(r),!!(32&r.__u),a),n.__v=r.__v,n.__.__k[n.__i]=n,Be(o,n,a),r.__e=r.__=null,n.__e!=s&&Fe(n)));Q.__r=0}function Me(t,e,n,r,s,o,a,c,_,l,p){var i,d,u,b,L,E,y,m=r&&r.__k||Ie,f=e.length;for(_=_t(n,e,m,_,f),i=0;i<f;i++)(u=n.__k[i])!=null&&(d=u.__i==-1?B:m[u.__i]||B,u.__i=i,E=ue(t,u,d,s,o,a,c,_,l,p),b=u.__e,u.ref&&d.ref!=u.ref&&(d.ref&&de(d.ref,null,u),p.push(u.ref,u.__c||b,u)),L==null&&b!=null&&(L=b),(y=!!(4&u.__u))||d.__k===u.__k?_=Ue(u,_,t,y):typeof u.type=="function"&&E!==void 0?_=E:b&&(_=b.nextSibling),u.__u&=-7);return n.__e=L,_}function _t(t,e,n,r,s){var o,a,c,_,l,p=n.length,i=p,d=0;for(t.__k=new Array(s),o=0;o<s;o++)(a=e[o])!=null&&typeof a!="boolean"&&typeof a!="function"?(_=o+d,(a=t.__k[o]=typeof a=="string"||typeof a=="number"||typeof a=="bigint"||a.constructor==String?V(null,a,null,null,null):ee(a)?V(W,{children:a},null,null,null):a.constructor==null&&a.__b>0?V(a.type,a.props,a.key,a.ref?a.ref:null,a.__v):a).__=t,a.__b=t.__b+1,c=null,(l=a.__i=ut(a,n,_,i))!=-1&&(i--,(c=n[l])&&(c.__u|=2)),c==null||c.__v==null?(l==-1&&(s>p?d--:s<p&&d++),typeof a.type!="function"&&(a.__u|=4)):l!=_&&(l==_-1?d--:l==_+1?d++:(l>_?d--:d++,a.__u|=4))):t.__k[o]=null;if(i)for(o=0;o<p;o++)(c=n[o])!=null&&!(2&c.__u)&&(c.__e==r&&(r=U(c)),We(c,c));return r}function Ue(t,e,n,r){var s,o;if(typeof t.type=="function"){for(s=t.__k,o=0;s&&o<s.length;o++)s[o]&&(s[o].__=t,e=Ue(s[o],e,n,r));return e}t.__e!=e&&(r&&(e&&t.type&&!e.parentNode&&(e=U(t)),n.insertBefore(t.__e,e||null)),e=t.__e);do e=e&&e.nextSibling;while(e!=null&&e.nodeType==8);return e}function ut(t,e,n,r){var s,o,a,c=t.key,_=t.type,l=e[n],p=l!=null&&(2&l.__u)==0;if(l===null&&t.key==null||p&&c==l.key&&_==l.type)return n;if(r>(p?1:0)){for(s=n-1,o=n+1;s>=0||o<e.length;)if((l=e[a=s>=0?s--:o++])!=null&&!(2&l.__u)&&c==l.key&&_==l.type)return a}return-1}function ye(t,e,n){e[0]=="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||lt.test(e)?n:n+"px"}function z(t,e,n,r,s){var o,a;e:if(e=="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||ye(t.style,e,"");if(n)for(e in n)r&&n[e]==r[e]||ye(t.style,e,n[e])}else if(e[0]=="o"&&e[1]=="n")o=e!=(e=e.replace(je,"$1")),a=e.toLowerCase(),e=a in t||e=="onFocusOut"||e=="onFocusIn"?a.slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=n,n?r?n.u=r.u:(n.u=ce,t.addEventListener(e,o?se:oe,o)):t.removeEventListener(e,o?se:oe,o);else{if(s=="http://www.w3.org/2000/svg")e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!="width"&&e!="height"&&e!="href"&&e!="list"&&e!="form"&&e!="tabIndex"&&e!="download"&&e!="rowSpan"&&e!="colSpan"&&e!="role"&&e!="popover"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e[4]!="-"?t.removeAttribute(e):t.setAttribute(e,e=="popover"&&n==1?"":n))}}function ve(t){return function(e){if(this.l){var n=this.l[e.type+t];if(e.t==null)e.t=ce++;else if(e.t<n.u)return;return n(w.event?w.event(e):e)}}}function ue(t,e,n,r,s,o,a,c,_,l){var p,i,d,u,b,L,E,y,m,f,g,P,T,I,O,A,F,S=e.type;if(e.constructor!=null)return null;128&n.__u&&(_=!!(32&n.__u),o=[c=e.__e=n.__e]),(p=w.__b)&&p(e);e:if(typeof S=="function")try{if(y=e.props,m="prototype"in S&&S.prototype.render,f=(p=S.contextType)&&r[p.__c],g=p?f?f.props.value:p.__:r,n.__c?E=(i=e.__c=n.__c).__=i.__E:(m?e.__c=i=new S(y,g):(e.__c=i=new Y(y,g),i.constructor=S,i.render=ft),f&&f.sub(i),i.props=y,i.state||(i.state={}),i.context=g,i.__n=r,d=i.__d=!0,i.__h=[],i._sb=[]),m&&i.__s==null&&(i.__s=i.state),m&&S.getDerivedStateFromProps!=null&&(i.__s==i.state&&(i.__s=$({},i.__s)),$(i.__s,S.getDerivedStateFromProps(y,i.__s))),u=i.props,b=i.state,i.__v=e,d)m&&S.getDerivedStateFromProps==null&&i.componentWillMount!=null&&i.componentWillMount(),m&&i.componentDidMount!=null&&i.__h.push(i.componentDidMount);else{if(m&&S.getDerivedStateFromProps==null&&y!==u&&i.componentWillReceiveProps!=null&&i.componentWillReceiveProps(y,g),!i.__e&&i.shouldComponentUpdate!=null&&i.shouldComponentUpdate(y,i.__s,g)===!1||e.__v==n.__v){for(e.__v!=n.__v&&(i.props=y,i.state=i.__s,i.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.some(function(h){h&&(h.__=e)}),P=0;P<i._sb.length;P++)i.__h.push(i._sb[P]);i._sb=[],i.__h.length&&a.push(i);break e}i.componentWillUpdate!=null&&i.componentWillUpdate(y,i.__s,g),m&&i.componentDidUpdate!=null&&i.__h.push(function(){i.componentDidUpdate(u,b,L)})}if(i.context=g,i.props=y,i.__P=t,i.__e=!1,T=w.__r,I=0,m){for(i.state=i.__s,i.__d=!1,T&&T(e),p=i.render(i.props,i.state,i.context),O=0;O<i._sb.length;O++)i.__h.push(i._sb[O]);i._sb=[]}else do i.__d=!1,T&&T(e),p=i.render(i.props,i.state,i.context),i.state=i.__s;while(i.__d&&++I<25);i.state=i.__s,i.getChildContext!=null&&(r=$($({},r),i.getChildContext())),m&&!d&&i.getSnapshotBeforeUpdate!=null&&(L=i.getSnapshotBeforeUpdate(u,b)),A=p,p!=null&&p.type===W&&p.key==null&&(A=Re(p.props.children)),c=Me(t,ee(A)?A:[A],e,n,r,s,o,a,c,_,l),i.base=e.__e,e.__u&=-161,i.__h.length&&a.push(i),E&&(i.__E=i.__=null)}catch(h){if(e.__v=null,_||o!=null)if(h.then){for(e.__u|=_?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;o[o.indexOf(c)]=null,e.__e=c}else{for(F=o.length;F--;)_e(o[F]);ie(e)}else e.__e=n.__e,e.__k=n.__k,h.then||ie(e);w.__e(h,e,n)}else o==null&&e.__v==n.__v?(e.__k=n.__k,e.__e=n.__e):c=e.__e=dt(n.__e,e,n,r,s,o,a,_,l);return(p=w.diffed)&&p(e),128&e.__u?void 0:c}function ie(t){t&&t.__c&&(t.__c.__e=!0),t&&t.__k&&t.__k.forEach(ie)}function Be(t,e,n){for(var r=0;r<n.length;r++)de(n[r],n[++r],n[++r]);w.__c&&w.__c(e,t),t.some(function(s){try{t=s.__h,s.__h=[],t.some(function(o){o.call(s)})}catch(o){w.__e(o,s.__v)}})}function Re(t){return typeof t!="object"||t==null||t.__b&&t.__b>0?t:ee(t)?t.map(Re):$({},t)}function dt(t,e,n,r,s,o,a,c,_){var l,p,i,d,u,b,L,E=n.props,y=e.props,m=e.type;if(m=="svg"?s="http://www.w3.org/2000/svg":m=="math"?s="http://www.w3.org/1998/Math/MathML":s||(s="http://www.w3.org/1999/xhtml"),o!=null){for(l=0;l<o.length;l++)if((u=o[l])&&"setAttribute"in u==!!m&&(m?u.localName==m:u.nodeType==3)){t=u,o[l]=null;break}}if(t==null){if(m==null)return document.createTextNode(y);t=document.createElementNS(s,m,y.is&&y),c&&(w.__m&&w.__m(e,o),c=!1),o=null}if(m==null)E===y||c&&t.data==y||(t.data=y);else{if(o=o&&Z.call(t.childNodes),E=n.props||B,!c&&o!=null)for(E={},l=0;l<t.attributes.length;l++)E[(u=t.attributes[l]).name]=u.value;for(l in E)if(u=E[l],l!="children"){if(l=="dangerouslySetInnerHTML")i=u;else if(!(l in y)){if(l=="value"&&"defaultValue"in y||l=="checked"&&"defaultChecked"in y)continue;z(t,l,null,u,s)}}for(l in y)u=y[l],l=="children"?d=u:l=="dangerouslySetInnerHTML"?p=u:l=="value"?b=u:l=="checked"?L=u:c&&typeof u!="function"||E[l]===u||z(t,l,u,E[l],s);if(p)c||i&&(p.__html==i.__html||p.__html==t.innerHTML)||(t.innerHTML=p.__html),e.__k=[];else if(i&&(t.innerHTML=""),Me(e.type=="template"?t.content:t,ee(d)?d:[d],e,n,r,m=="foreignObject"?"http://www.w3.org/1999/xhtml":s,o,a,o?o[0]:n.__k&&U(n,0),c,_),o!=null)for(l=o.length;l--;)_e(o[l]);c||(l="value",m=="progress"&&b==null?t.removeAttribute("value"):b!=null&&(b!==t[l]||m=="progress"&&!b||m=="option"&&b!=E[l])&&z(t,l,b,E[l],s),l="checked",L!=null&&L!=t[l]&&z(t,l,L,E[l],s))}return t}function de(t,e,n){try{if(typeof t=="function"){var r=typeof t.__u=="function";r&&t.__u(),r&&e==null||(t.__u=t(e))}else t.current=e}catch(s){w.__e(s,n)}}function We(t,e,n){var r,s;if(w.unmount&&w.unmount(t),(r=t.ref)&&(r.current&&r.current!=t.__e||de(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(o){w.__e(o,e)}r.base=r.__P=null}if(r=t.__k)for(s=0;s<r.length;s++)r[s]&&We(r[s],e,n||typeof t.type!="function");n||_e(t.__e),t.__c=t.__=t.__e=void 0}function ft(t,e,n){return this.constructor(t,n)}function qe(t,e,n){var r,s,o,a;e==document&&(e=document.documentElement),w.__&&w.__(t,e),s=(r=!1)?null:e.__k,o=[],a=[],ue(e,t=e.__k=ct(W,null,[t]),s||B,B,e.namespaceURI,s?null:e.firstChild?Z.call(e.childNodes):null,o,s?s.__e:e.firstChild,r,a),Be(o,t,a)}Z=Ie.slice,w={__e:function(t,e,n,r){for(var s,o,a;e=e.__;)if((s=e.__c)&&!s.__)try{if((o=s.constructor)&&o.getDerivedStateFromError!=null&&(s.setState(o.getDerivedStateFromError(t)),a=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(t,r||{}),a=s.__d),a)return s.__E=s}catch(c){t=c}throw t}},Oe=0,Y.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=$({},this.state),typeof t=="function"&&(t=t($({},n),this.props)),t&&$(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),me(this))},Y.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),me(this))},Y.prototype.render=W,j=[],De=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ne=function(t,e){return t.__v.__b-e.__v.__b},Q.__r=0,je=/(PointerCapture)$|Capture$/i,ce=0,oe=ve(!1),se=ve(!0);var pt=0;function v(t,e,n,r,s,o){e||(e={});var a,c,_=e;if("ref"in _)for(c in _={},e)c=="ref"?a=e[c]:_[c]=e[c];var l={type:t,props:_,key:n,ref:a,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--pt,__i:-1,__u:0,__source:s,__self:o};if(typeof t=="function"&&(a=t.defaultProps))for(c in a)_[c]===void 0&&(_[c]=a[c]);return w.vnode&&w.vnode(l),l}var R,k,te,ge,X=0,ze=[],x=w,we=x.__b,be=x.__r,Ee=x.diffed,ke=x.__c,xe=x.unmount,Le=x.__;function fe(t,e){x.__h&&x.__h(k,t,X||e),X=0;var n=k.__H||(k.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function N(t){return X=1,ht(Ye,t)}function ht(t,e,n){var r=fe(R++,2);if(r.t=t,!r.__c&&(r.__=[Ye(void 0,e),function(c){var _=r.__N?r.__N[0]:r.__[0],l=r.t(_,c);_!==l&&(r.__N=[l,r.__[1]],r.__c.setState({}))}],r.__c=k,!k.__f)){var s=function(c,_,l){if(!r.__c.__H)return!0;var p=r.__c.__H.__.filter(function(d){return!!d.__c});if(p.every(function(d){return!d.__N}))return!o||o.call(this,c,_,l);var i=r.__c.props!==c;return p.forEach(function(d){if(d.__N){var u=d.__[0];d.__=d.__N,d.__N=void 0,u!==d.__[0]&&(i=!0)}}),o&&o.call(this,c,_,l)||i};k.__f=!0;var o=k.shouldComponentUpdate,a=k.componentWillUpdate;k.componentWillUpdate=function(c,_,l){if(this.__e){var p=o;o=void 0,s(c,_,l),o=p}a&&a.call(this,c,_,l)},k.shouldComponentUpdate=s}return r.__N||r.__}function J(t,e){var n=fe(R++,3);!x.__s&&Ve(n.__H,e)&&(n.__=t,n.u=e,k.__H.__h.push(n))}function Ke(t){return X=5,mt(function(){return{current:t}},[])}function mt(t,e){var n=fe(R++,7);return Ve(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function yt(){for(var t;t=ze.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(G),t.__H.__h.forEach(ae),t.__H.__h=[]}catch(e){t.__H.__h=[],x.__e(e,t.__v)}}x.__b=function(t){k=null,we&&we(t)},x.__=function(t,e){t&&e.__k&&e.__k.__m&&(t.__m=e.__k.__m),Le&&Le(t,e)},x.__r=function(t){be&&be(t),R=0;var e=(k=t.__c).__H;e&&(te===k?(e.__h=[],k.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(e.__h.forEach(G),e.__h.forEach(ae),e.__h=[],R=0)),te=k},x.diffed=function(t){Ee&&Ee(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(ze.push(e)!==1&&ge===x.requestAnimationFrame||((ge=x.requestAnimationFrame)||vt)(yt)),e.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),te=k=null},x.__c=function(t,e){e.some(function(n){try{n.__h.forEach(G),n.__h=n.__h.filter(function(r){return!r.__||ae(r)})}catch(r){e.some(function(s){s.__h&&(s.__h=[])}),e=[],x.__e(r,n.__v)}}),ke&&ke(t,e)},x.unmount=function(t){xe&&xe(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{G(r)}catch(s){e=s}}),n.__H=void 0,e&&x.__e(e,n.__v))};var Ce=typeof requestAnimationFrame=="function";function vt(t){var e,n=function(){clearTimeout(r),Ce&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,35);Ce&&(e=requestAnimationFrame(n))}function G(t){var e=k,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),k=e}function ae(t){var e=k;t.__c=t.__(),k=e}function Ve(t,e){return!t||t.length!==e.length||e.some(function(n,r){return n!==t[r]})}function Ye(t,e){return typeof e=="function"?e(t):e}function gt(){const t=Ke(null);return J(()=>{const e="calendly-widget-js";if(!document.getElementById(e)){const n=document.createElement("script");n.id=e,n.src="https://assets.calendly.com/assets/external/widget.js",n.async=!0,document.body.appendChild(n)}},[]),v("section",{id:"contact",class:"contact-section",children:[v("h2",{class:"section-title",children:"Contact"}),v("div",{class:"calendly-wrap",children:v("div",{ref:t,class:"calendly-inline-widget","data-url":"https://calendly.com/leoklemet/30min"})})]})}const Se=document.getElementById("contact-root");Se&&(qe(v(gt,{}),Se),console.log("Contact component initialized"));const le="portfolio:assistant:hidden";function K(t){const e=document.getElementById("assistant-panel"),n=document.getElementById("assistant-hide-btn");if(!(!e||!n)){e.style.display=t?"none":"block",e.dataset.hidden=t?"1":"0",n.setAttribute("aria-pressed",t?"true":"false");try{localStorage.setItem(le,t?"1":"0")}catch(r){console.warn("Could not persist assistant visibility:",r)}}}function wt(){let t=!1;try{t=localStorage.getItem(le)==="1"}catch{}K(t);const e=document.getElementById("assistant-hide-btn");e&&e.addEventListener("click",()=>{try{const n=localStorage.getItem(le)==="1";K(!n)}catch{const n=document.getElementById("assistant-panel"),r=(n==null?void 0:n.style.display)==="none";K(!r)}}),document.addEventListener("keydown",n=>{n.key==="Escape"&&K(!0)})}function bt(t){return t.currentTarget.value}const $e="layout:update",Je="";function C(){return Date.now()}function Pe(t){return new Date(t).toLocaleTimeString()}async function Et(t){var r,s,o;const e=await fetch(`${Je}/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:t}),credentials:"include"});if(!e.ok)throw new Error(`chat failed: ${e.status}`);const n=await e.json();return n.content||((o=(s=(r=n.choices)==null?void 0:r[0])==null?void 0:s.message)==null?void 0:o.content)||"No response"}async function kt(t,{onDelta:e,onDone:n,onError:r}){var _,l,p,i;const s=await fetch(`${Je}/chat/stream`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:t}),credentials:"include"});if(!s.ok||!s.body){r(new Error(`stream failed: ${s.status}`));return}const o=s.body.getReader(),a=new TextDecoder;let c="";try{for(;;){const{value:d,done:u}=await o.read();if(u)break;c+=a.decode(d,{stream:!0});let b;for(;(b=c.indexOf(`

`))>=0;){const L=c.slice(0,b);c=c.slice(b+2);const E=L.split(`
`).find(m=>m.startsWith("data:"));if(!E)continue;const y=E.slice(5).trim();if(y==="[DONE]"){n();return}try{const m=JSON.parse(y),f=((_=m.delta)==null?void 0:_.content)||((i=(p=(l=m.choices)==null?void 0:l[0])==null?void 0:p.delta)==null?void 0:i.content)||"";if(f&&e(f),m.done){n();return}}catch{e(y)}}}n()}catch(d){r(d)}}function xt(){const[t,e]=N(Ze()),[n,r]=N([{role:"system",text:"Assistant ready. Type below and press Enter.",ts:C()}]),[s,o]=N(""),[a,c]=N(!1),[_,l]=N(!1),[p,i]=N(!0),[d,u]=N(!1),b=Ke(null);J(()=>{(async()=>l(await pe()))();const f=async()=>l(await pe());return window.addEventListener("focus",f),()=>window.removeEventListener("focus",f)},[]),J(()=>{const f=g=>e(g.detail);return window.addEventListener($e,f),()=>window.removeEventListener($e,f)},[]),J(()=>{const f=b.current;f&&(f.scrollTop=f.scrollHeight)},[n]);async function L(f){var O,A,F,S;const g=f.trim();if(!g)return;if(d){r(h=>[...h,{role:"event",text:"[error] Assistant API is offline. Please try again later.",ts:C()}]);return}r(h=>[...h,{role:"user",text:g,ts:C()}]),o(""),c(!0);const P=n.filter(h=>h.role==="user"||h.role==="assistant").slice(-5).map(h=>({role:h.role,content:h.text}));P.push({role:"user",content:g});let T=!1,I="";try{await kt(P,{onDelta:h=>{T=!0,I+=h,r(H=>{const M=H[H.length-1];return M&&M.role==="assistant"&&M.ts>C()-5e3?[...H.slice(0,-1),{...M,text:I}]:[...H,{role:"assistant",text:I,ts:C()}]})},onDone:()=>{c(!1),u(!1)},onError:h=>{console.error("[chat] stream error:",h)}})}catch(h){console.warn("[chat] streaming failed, trying non-stream:",h)}if(!T){try{const h=await Et(P);r(H=>[...H,{role:"assistant",text:h,ts:C()}]),u(!1)}catch(h){const H=(O=h==null?void 0:h.message)!=null&&O.includes("Failed to fetch")||(A=h==null?void 0:h.message)!=null&&A.includes("NetworkError")?"[error] Cannot reach assistant API - please check connection":`[error] ${String(h)}`;r(M=>[...M,{role:"event",text:H,ts:C()}]),((F=h==null?void 0:h.message)!=null&&F.includes("Failed to fetch")||(S=h==null?void 0:h.message)!=null&&S.includes("NetworkError"))&&u(!0)}c(!1)}}function E(f){f.key==="Enter"&&!f.shiftKey&&(f.preventDefault(),L(s))}async function y(){try{const f=await fetch("/api/layout/autotune",{method:"POST",credentials:"include"});if(!f.ok){r(g=>[...g,{role:"event",text:`[autotune] ${f.status} ${f.statusText}`,ts:C()}]);return}r(g=>[...g,{role:"event",text:"[autotune] layout optimized",ts:C()}]),await ne()}catch(f){r(g=>[...g,{role:"event",text:`[autotune] error: ${String(f)}`,ts:C()}])}}async function m(){try{const f=await fetch("/api/layout/reset",{method:"POST",credentials:"include"});if(!f.ok){r(g=>[...g,{role:"event",text:`[reset] ${f.status} ${f.statusText}`,ts:C()}]);return}r(g=>[...g,{role:"event",text:"[reset] layout reset to default",ts:C()}]),await ne()}catch(f){r(g=>[...g,{role:"event",text:`[reset] error: ${String(f)}`,ts:C()}])}}return v("div",{class:`assistant-panel${p?"":" hidden"}`,"data-testid":"assistant-panel",children:[v("div",{class:"hdr",style:"display:flex; align-items:center; gap:.5rem; justify-content:space-between;",children:[v("div",{style:"display:flex; align-items:center; gap:.5rem;",children:[v("div",{style:"font-weight:600;",children:"Portfolio Assistant"}),_&&v("span",{class:"asst-badge-admin",children:"admin"}),d&&v("span",{class:"asst-badge-offline",title:"Assistant API is offline",style:"background:#ef4444; color:white; padding:2px 6px; border-radius:4px; font-size:11px; font-weight:600;",children:"offline"})]}),v("div",{class:"asst-controls",style:"display:flex; gap:.25rem;",children:[_&&v(W,{children:[v("button",{class:"btn-sm",onClick:y,title:"Admin only: Autotune layout","data-testid":"btn-autotune",children:"Autotune"}),v("button",{class:"btn-sm",onClick:m,title:"Admin only: Reset layout","data-testid":"btn-reset",children:"Reset"})]}),v("button",{id:"assistant-hide-btn",class:"btn-sm","aria-pressed":"false",title:"Hide panel (persists across reload)",children:"Hide"})]})]}),v("div",{ref:b,class:"asst-log","data-testid":"assistant-log",children:[n.map((f,g)=>v("div",{class:`row ${f.role}`,children:[v("span",{class:"ts",children:Pe(f.ts)}),v("span",{class:"bubble",children:f.text})]},g)),a&&v("div",{class:"row event",children:[v("span",{class:"ts",children:Pe(C())}),v("span",{class:"bubble",children:"â€¦streaming"})]})]}),v("div",{class:"asst-compose",children:[v("textarea",{"aria-label":"Message",placeholder:d?"Assistant offline - cannot send messages":"Type a messageâ€¦",value:s,onInput:f=>o(bt(f)),onKeyDown:f=>E(f),rows:1,disabled:d,style:d?{opacity:.5,cursor:"not-allowed"}:{}}),v("button",{class:"btn",onClick:()=>void L(s),disabled:a||d,"data-testid":"assistant-send",title:d?"API is offline":void 0,children:a?"Sendingâ€¦":d?"Offline":"Send"})]}),v("details",{class:"asst-debug",children:[v("summary",{children:"Layout"}),v("pre",{children:JSON.stringify(t,null,2)})]})]})}const Te=document.getElementById("assistant-root");Te&&(qe(v(xt,{}),Te),wt());
//# sourceMappingURL=main-BWMj-_BO.js.map
