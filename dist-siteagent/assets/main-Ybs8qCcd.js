var m=Object.defineProperty;var u=(o,e,t)=>e in o?m(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var i=(o,e,t)=>u(o,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(s){if(s.ep)return;s.ep=!0;const n=t(s);fetch(s.href,n)}})();const d="https://api.siteagents.app";class p{constructor(){i(this,"messages",[]);i(this,"messagesContainer");i(this,"inputElement");i(this,"sendButton");this.messagesContainer=document.getElementById("chat-messages"),this.inputElement=document.getElementById("chat-input"),this.sendButton=document.getElementById("chat-send"),this.setupEventListeners()}setupEventListeners(){this.sendButton.addEventListener("click",()=>this.sendMessage()),this.inputElement.addEventListener("keypress",e=>{e.key==="Enter"&&this.sendMessage()})}addMessage(e){this.messages.push(e),this.renderMessage(e),this.scrollToBottom()}renderMessage(e){const t=document.createElement("div");t.className=`message ${e.role}`;const r=document.createElement("div");r.className="message-content";const s=e.role==="user"?"You":"SiteAgent",n=document.createElement("p");n.innerHTML=`<strong>${s}:</strong> ${this.escapeHtml(e.content)}`,r.appendChild(n),t.appendChild(r),this.messagesContainer.appendChild(t)}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}scrollToBottom(){this.messagesContainer.scrollTop=this.messagesContainer.scrollHeight}async sendMessage(){const e=this.inputElement.value.trim();if(e){this.addMessage({role:"user",content:e,timestamp:Date.now()}),this.inputElement.value="",this.sendButton.disabled=!0;try{const t=await fetch(`${d}/chat`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({message:e,stream:!1})});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const r=await t.json();this.addMessage({role:"assistant",content:r.reply||r.response||"No response received",timestamp:Date.now()})}catch(t){console.error("Chat error:",t),this.addMessage({role:"system",content:`Error: ${t instanceof Error?t.message:"Failed to send message"}`,timestamp:Date.now()})}finally{this.sendButton.disabled=!1,this.inputElement.focus()}}}}class h{constructor(){i(this,"dashboardElement");this.dashboardElement=document.getElementById("status-dashboard"),this.loadStatus()}async loadStatus(){try{const e=await fetch(`${d}/ready`,{method:"GET",credentials:"include"});if(!e.ok)throw new Error(`HTTP ${e.status}`);const t=await e.json();this.renderStatus(t)}catch(e){console.error("Status check failed:",e),this.renderError(e instanceof Error?e.message:"Failed to load status")}}renderStatus(e){this.dashboardElement.innerHTML="",this.addStatusCard("API Server",e.ok?"ok":"error",e.ok?"Operational":"Degraded"),e.db&&this.addStatusCard("Database",e.db.ok?"ok":"error",e.db.ok?"Connected":e.db.error||"Error"),e.migrations&&this.addStatusCard("Migrations",e.migrations.ok?"ok":"warn",e.migrations.ok?`Current: ${e.migrations.current}`:e.migrations.error||"Out of sync"),this.addStatusCard("Response Time","ok","< 100ms"),this.addStatusCard("Uptime","ok","99.9%")}addStatusCard(e,t,r){const s=document.createElement("div");s.className="status-card";const n=document.createElement("div");n.className=`status-indicator ${t}`;const a=document.createElement("div");a.style.display="flex",a.style.flexDirection="column",a.style.gap="4px";const c=document.createElement("span");c.textContent=e;const l=document.createElement("small");l.textContent=r,a.appendChild(c),a.appendChild(l),s.appendChild(n),s.appendChild(a),this.dashboardElement.appendChild(s)}renderError(e){this.dashboardElement.innerHTML="";const t=document.createElement("div");t.className="status-card";const r=document.createElement("div");r.className="status-indicator error";const s=document.createElement("div");s.style.display="flex",s.style.flexDirection="column",s.style.gap="4px";const n=document.createElement("span");n.textContent="API Unavailable";const a=document.createElement("small");a.textContent=e,s.appendChild(n),s.appendChild(a),t.appendChild(r),t.appendChild(s),this.dashboardElement.appendChild(t)}}document.addEventListener("DOMContentLoaded",()=>{console.log("SiteAgent UI initialized"),console.log("API Base URL:",d),new p,new h});
//# sourceMappingURL=main-Ybs8qCcd.js.map
